# Disable cgroups (required for Docker/Cloud Run)
use_cgroup = false

# MODE: EXEC (just sandbox a command)
mode = "EXECVE"

# Time limit (seconds)
time_limit = 5

# Maximum memory (bytes)
rlimit_as = 512 * 1024 * 1024      # 512MB
# Maximum stack (bytes)
rlimit_stack = 64 * 1024 * 1024    # 64MB

# Disable networking for safety
disable_proc = false
clone_newnet = true

# New PID namespace so the process can't see host processes
clone_newpid = true

# New UTS namespace
clone_newuts = true

# New mount namespace
clone_newmnt = true

# Map user to nobody (unprivileged)
uidmap {
    inside_id: 65534
    outside_id: 65534
    count: 1
}

gidmap {
    in
